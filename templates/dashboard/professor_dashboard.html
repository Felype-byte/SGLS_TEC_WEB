{% extends 'base_dashboard_professor.html' %} {% block title %}Painel do
Professor â€“ SGHL{% endblock %} {% block content %}
<div class="painel-professor-main">
  <div class="painel-professor">
    <h4 class="painel-professor-titulo mb-4">
      <i class="bi bi-mortarboard-fill" style="color: #002e53"></i> Painel do
      Professor
    </h4>

    <form
      method="POST"
      action="{{ url_for('professor.agendamento_professor') }}"
      class="form-agendamento"
    >
      <!-- Linha de inputs: LaboratÃ³rio e Data -->
      <div class="painel-section-row mb-4">
        <div class="painel-section">
          <label for="sala_id">1. LaboratÃ³rio</label>
          <select
            name="sala_id"
            id="sala_id"
            class="form-control painel-input painel-select"
            required
          >
            <option selected disabled value="">Selecione...</option>
            {% for sala in salas %}
            <option value="{{ sala.id_sala }}">
              {{ sala.nome_sala }} ({{ sala.bloco }} â€“ Sala {{ sala.numero_sala
              }})
            </option>
            {% endfor %}
          </select>
        </div>
        <div class="painel-section">
          <label for="data">2. Data</label>
          <input
            type="date"
            name="data"
            id="data"
            class="form-control painel-input"
            required
          />
        </div>
      </div>

      <!-- Linha de justificativa -->
      <div class="painel-section mb-4">
        <label for="justificativa">3. Justificativa</label>
        <textarea
          name="justificativa"
          id="justificativa"
          rows="2"
          class="form-control painel-input"
          placeholder="Descreva o motivo..."
        ></textarea>
      </div>

      <!-- BotÃ£o Ver HorÃ¡rios -->
      <div class="painel-actionbar text-right mb-3">
        <button
          type="button"
          class="btn btn-outline-terra btn-ver-horarios"
          onclick="carregarHorarios()"
        >
          <i class="bi bi-search"></i> Ver HorÃ¡rios
        </button>
      </div>

      <!-- HorÃ¡rios disponÃ­veis -->
      <div class="painel-section">
        <label class="painel-section">4. HorÃ¡rios disponÃ­veis</label>
        <div id="grade-horarios" class="painel-horarios-list row">
          <p class="text-muted ml-3">
            Selecione laboratÃ³rio e data para ver horÃ¡rios.
          </p>
          <!-- Exemplo de como JS irÃ¡ montar cada slot -->
          <!--
          <div class="col-md-4 mb-3">
            <label class="horario-slot painel-horario-slot horario-disponivel d-block text-center py-3 px-2 rounded shadow-sm" tabindex="0" title="HorÃ¡rio disponÃ­vel para seleÃ§Ã£o">
              <input type="radio" name="horario_id" value="123" class="d-none" data-status="DisponÃ­vel">
              <span class="icon-status mr-2">â¬œ</span>
              <span class="slot-text">08:00 - 10:00</span>
            </label>
          </div>
          <div class="col-md-4 mb-3">
            <label class="horario-slot painel-horario-slot horario-processo d-block text-center py-3 px-2 rounded shadow-sm" tabindex="0" title="HorÃ¡rio em anÃ¡lise. Aguarde confirmaÃ§Ã£o.">
              <input type="radio" name="horario_id" value="124" class="d-none" data-status="Em processo" disabled>
              <span class="icon-status mr-2">ðŸŸ¨</span>
              <span class="slot-text">10:00 - 12:00</span>
            </label>
          </div>
          <div class="col-md-4 mb-3">
            <label class="horario-slot painel-horario-slot horario-agendado d-block text-center py-3 px-2 rounded shadow-sm" tabindex="0" title="HorÃ¡rio jÃ¡ agendado. IndisponÃ­vel.">
              <input type="radio" name="horario_id" value="125" class="d-none" data-status="Agendado" disabled>
              <span class="icon-status mr-2">ðŸŸ©</span>
              <span class="slot-text">14:00 - 16:00</span>
            </label>
          </div>
          <div class="col-md-4 mb-3">
            <label class="horario-slot painel-horario-slot horario-indisponivel d-block text-center py-3 px-2 rounded shadow-sm" tabindex="0" title="HorÃ¡rio reservado ou nÃ£o disponÃ­vel.">
              <input type="radio" name="horario_id" value="126" class="d-none" data-status="IndisponÃ­vel" disabled>
              <span class="icon-status mr-2">ðŸ”˜</span>
              <span class="slot-text">16:00 - 18:00</span>
            </label>
          </div>
          -->
        </div>
      </div>

      <!-- Legenda -->
      <div class="painel-legenda mb-4">
        <span>Legenda:</span>
        <span class="badge badge-disponivel"
          ><span class="icon-status mr-1">â¬œ</span>DisponÃ­vel</span
        >
        <span class="badge badge-selecionado"
          ><span class="icon-status mr-1">ðŸŸ¦</span>Selecionado</span
        >
        <span class="badge badge-confirmado"
          ><span class="icon-status mr-1">ðŸŸ©</span>Confirmado</span
        >
        <span class="badge badge-analise"
          ><span class="icon-status mr-1">ðŸŸ¨</span>Em processo</span
        >
        <span class="badge badge-outros"
          ><span class="icon-status mr-1">ðŸ”˜</span>Outros</span
        >
      </div>

      <!-- BotÃ£o Solicitar Uso -->
      <div class="painel-actionbar text-right mb-4">
        <button type="submit" class="btn btn-terra btn-solicitar-uso btn-lg">
          <i class="bi bi-send-fill mr-2"></i>Solicitar Uso
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal de Minhas SolicitaÃ§Ãµes -->
<div
  class="modal fade"
  id="modalAgendamentoStatus"
  tabindex="-1"
  role="dialog"
  aria-labelledby="modalAgendamentoStatusLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content modal-solicitacoes">
      <div class="modal-header">
        <h5 class="modal-title" id="modalAgendamentoStatusLabel">
          Minhas SolicitaÃ§Ãµes
        </h5>
        <button
          type="button"
          class="close btn-fechar-modal"
          data-dismiss="modal"
          aria-label="Fechar"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body modal-scroll">
        {% if solicitacoes %}
        <ul class="list-group lista-solicitacoes">
          {% for s in solicitacoes %}
          <li
            class="list-group-item item-solicitacao d-flex justify-content-between align-items-start"
          >
            <div class="info-solicitacao">
              <p class="mb-1">
                <strong>HorÃ¡rio:</strong> {{ s.horario.texto }} â€“ {{
                s.horario.data.strftime('%d/%m/%Y') }}
              </p>
              <p class="mb-1">
                <strong>Sala:</strong> {{ s.sala.nome_sala }} â€“ {{
                s.sala.numero_sala }} â€“ Bloco {{ s.sala.bloco }}
              </p>
              {% if s.justificativa %}
              <p class="mb-1">
                <strong>Justificativa:</strong> {{ s.justificativa }}
              </p>
              {% endif %}
            </div>
            <div class="acoes-solicitacao text-right ml-3">
              <span
                class="badge {% if s.status == 'Pendente Tecnico' %}badge-analise {% elif s.status == 'Agendado' %}badge-confirmado {% elif s.status == 'Cancelado pelo professor' %}badge-outros {% else %}badge-outros{% endif %}"
              >
                {% if s.status == 'Pendente Tecnico' %}<span
                  class="icon-status mr-1"
                  >ðŸŸ¨</span
                >
                Aguardando anÃ¡lise do TÃ©cnico {% elif s.status == 'Agendado'
                %}<span class="icon-status mr-1">ðŸŸ©</span> Confirmado {% elif
                s.status == 'Cancelado pelo professor' %}<span
                  class="icon-status mr-1"
                  >âšª</span
                >
                Cancelado {% else %}<span class="icon-status mr-1">ðŸ”˜</span> {{
                s.status }} {% endif %}
              </span>
              {% if s.status in ['Pendente Tecnico', 'Agendado'] %}
              <form
                method="POST"
                action="{{ url_for('professor.cancelar_solicitacao', id=s.id_solicitacao) }}"
                class="form-cancelar-solicitacao mt-2"
                onsubmit="return confirm('Deseja cancelar esta solicitaÃ§Ã£o?')"
              >
                <button
                  class="btn btn-cancelar btn-sm d-flex align-items-center"
                >
                  <span class="icon-cancelar mr-2"
                    ><i class="bi bi-x-circle-fill"></i
                  ></span>
                  Cancelar
                </button>
              </form>
              {% endif %}
            </div>
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="text-muted">Nenhuma solicitaÃ§Ã£o feita atÃ© o momento.</p>
        {% endif %}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-fechar-modal" data-dismiss="modal">
          Fechar
        </button>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block extra_scripts %}
<script src="{{ url_for('static', filename='js/professor_dashboard.js') }}"></script>
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/professor_dashboard.css') }}"
/>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
/>
{% endblock %}
